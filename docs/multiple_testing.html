<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Прикладная эконометрика - 2&nbsp; Множественное тестирование гипотез</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bad_control.html" rel="next">
<link href="./experiments.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="site_libs/grViz-binding-1.0.9/grViz.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./multiple_testing.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Множественное тестирование гипотез</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Прикладная эконометрика</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="mailto:annastavnychuk@gmail.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-at"></i></a>
    <a href="https://github.com/annastavniychuk" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Предисловие</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Эксперименты</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple_testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Множественное тестирование гипотез</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bad_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Плохой контроль</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prestratification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Престратификация</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subclassification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Постстратификация</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./high_dimension_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Регуляризация и большая размерность</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heterogenous_treatment_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Гетерогенные эффекты</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression_discontinuity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Разрывная регрессия</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./spatial_regression_discontinuity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Пространственная разрывная регрессия</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./synthetic_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Синтетический контроль</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./staggered_adoption.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Ступенчатая разность разностей</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./event_study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Событийный анализ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ссылки</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#проблема-множественного-тестирования-гипотез" id="toc-проблема-множественного-тестирования-гипотез" class="nav-link active" data-scroll-target="#проблема-множественного-тестирования-гипотез"><span class="header-section-number">2.1</span> Проблема множественного тестирования гипотез</a></li>
  <li><a href="#контроль-ошибок-первого-и-второго-рода" id="toc-контроль-ошибок-первого-и-второго-рода" class="nav-link" data-scroll-target="#контроль-ошибок-первого-и-второго-рода"><span class="header-section-number">2.2</span> Контроль ошибок первого и второго рода</a>
  <ul class="collapse">
  <li><a href="#групповая-вероятность-ошибки-первого-рода-family-wise-error-rate" id="toc-групповая-вероятность-ошибки-первого-рода-family-wise-error-rate" class="nav-link" data-scroll-target="#групповая-вероятность-ошибки-первого-рода-family-wise-error-rate"><span class="header-section-number">2.2.1</span> Групповая вероятность ошибки первого рода (family-wise error rate)</a></li>
  <li><a href="#средняя-доля-ложных-отклонений-false-discovery-rate" id="toc-средняя-доля-ложных-отклонений-false-discovery-rate" class="nav-link" data-scroll-target="#средняя-доля-ложных-отклонений-false-discovery-rate"><span class="header-section-number">2.2.2</span> Средняя доля ложных отклонений (false discovery rate)</a></li>
  </ul></li>
  <li><a href="#обобщающий-алгоритм-для-разных-процедур" id="toc-обобщающий-алгоритм-для-разных-процедур" class="nav-link" data-scroll-target="#обобщающий-алгоритм-для-разных-процедур"><span class="header-section-number">2.3</span> Обобщающий алгоритм для разных процедур</a></li>
  <li><a href="#симуляция-и-сравнение-результатов-работы-разных-коррекций-p-value" id="toc-симуляция-и-сравнение-результатов-работы-разных-коррекций-p-value" class="nav-link" data-scroll-target="#симуляция-и-сравнение-результатов-работы-разных-коррекций-p-value"><span class="header-section-number">2.4</span> Симуляция и сравнение результатов работы разных коррекций p-value</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Множественное тестирование гипотез</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="проблема-множественного-тестирования-гипотез" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="проблема-множественного-тестирования-гипотез"><span class="header-section-number">2.1</span> Проблема множественного тестирования гипотез</h2>
<p>Ваш исследовательский вопрос может быть таким, что вам интересно оценить воздействия разных типов тритмента, то есть у вас есть несколько экспериментальных групп и одна контрольная. При такой постановке мы хотим проверить не одну, а сразу много статистических гипотез о различии в группах. При проверке любой гипотезы существует вероятность совершить ошибку первого рода (отклонить нулевую гипотезу, если она верна = обнаружить эффект, которого нет). Особенность множественного тестирования гипотез состоит в том, что чем больше гипотез мы проверяем на одних и тех же данных, тем больше будет вероятность допустить как минимум одну ошибку первого рода – эффект множественных сравнений (multiple comparisons/testing).</p>
<p>Источниками множественного тестирования могут быть:</p>
<ul>
<li><p>Несколько типов воздействия (Multiple treatment arms)</p></li>
<li><p>Гетерогенное воздействие (Heterogeneous treatment effects)</p></li>
<li><p>Несколько способов оценки (Multiple estimators)</p></li>
<li><p>Несколько зависимых переменных (Multiple outcomes), эффект на которые мы хотим оценить</p></li>
</ul>
<p>Рассмотрим это на примере. Предположим, что у нас есть 3 группы (A, B и С), в которых мы хотим сравнить среднее значение переменной интереса. Как и ранее, мы будем использовать t-тест Стьюдента. Если мы получили достаточно большое значение t-статистики такое, что p-value &lt; 0.05, то мы отклоняем нулевую гипотезу и заключаем, что группы статистически различаются по переменной интереса. Отсечка p-value &lt; 0.05 значит, что вероятность ошибочного вывода о различии между групповыми средними не превышает 0.05. Это будет работать именно так, когда у нас всего две группы, но в случае множественного тестирования вероятность будет больше 5%.</p>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-1b1205d473c53e0960d6" style="width:100%;height:145px;" class="grViz html-widget "></div>
<script type="application/json" data-for="htmlwidget-1b1205d473c53e0960d6">{"x":{"diagram":"digraph {\n  graph [layout = neato, rankdir = LR]\n  \n  node [shape = circle]        \n  rec1 [label = \"A\"]\n  rec2 [label = \"B\"]\n  rec3 [label =  \"C\"]\n  \n  # edge definitions with the node IDs\n  rec1 -> rec2 #[label = \"5%\"]\n  rec2 -> rec3 #[label = \"5%\"]\n  rec3 -> rec1 #[label = \"5%\"]\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Выполняя тест Стьюдента, исследователь проверяет нулевую гипотезу об отсутствии разницы между двумя группами. Сравнивая группы A и В, он может ошибиться с вероятностью 5%, В и С – 5%, А и С – тоже 5%. Соответственно, вероятность ошибиться хотя бы в одном из этих трех сравнений составит:</p>
<p><span class="math inline">\(P = 1 - \left(1-\alpha \right)^n = 1 - 0.95^3 \approx 0.14 &gt; 0.05\)</span> – такая ошибка называется family-wise error rate</p>
<p>Если бы групп было бы 5:</p>
<p><span class="math inline">\(P = 1 - \left(1-\alpha \right)^n = 1 - 0.95^{10} \approx 0.4 &gt; 0.05\)</span></p>
<p>К счастью, существует несколько методов, позволяющих преодолеть эту сложность:</p>
<ul>
<li><p>Корректировка p-value (p-value adjustments)</p></li>
<li><p>Планирование эксперимента и фиксирование его условий (pre-analysis plans)</p></li>
<li><p>Повтороное проведение эксперимента (replication)</p></li>
</ul>
<p>В рамках курса мы будем обсуждать первый способ борьбы с ошибками, возникающими при множественном тестировании гипотез.</p>
</section>
<section id="контроль-ошибок-первого-и-второго-рода" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="контроль-ошибок-первого-и-второго-рода"><span class="header-section-number">2.2</span> Контроль ошибок первого и второго рода</h2>
<p>Предположим, что мы проверяем <span class="math inline">\(n\)</span> гипотез. Для каждой гипотезы мы будем проводить тест Стьюдента. Результаты наших тестов можно обобщить следующим образом:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Число принятых нулевых гипотез &nbsp;<span class="math inline">\((p-value &gt; \alpha) \Rightarrow \hat{\tau}=0\)</span></th>
<th>Число отвергнутых нулевых гипотез &nbsp;<span class="math inline">\((p-value &lt; \alpha) \Rightarrow \hat{\tau}\neq 0\)</span></th>
<th>Всего гипотез</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Число верных нулевых гипотез &nbsp;<span class="math inline">\(\hat{\tau}=0\)</span></td>
<td>Число безошибочно принятых нулевых гипотез (TN, true negatives)</td>
<td>Число ошибочно отвергнутых нулевых гипотез (FP, false positives) – ошибка первого рода</td>
<td><span class="math inline">\(m_0\)</span> – Число верных нулевых гипотез (true null hypotheses)</td>
</tr>
<tr class="even">
<td>Число неверных нулевых гипотез &nbsp;<span class="math inline">\(\hat{\tau}\neq 0\)</span></td>
<td>Число ошибочно принятых нулевых гипотез (FN, false negatives) – ошибка второго рода)</td>
<td>Число безошибочно отвергнутых нулевых гипотез (TP, true positives)</td>
<td><span class="math inline">\(m-m_0\)</span> – Число истинных альтернативных гипотез (true alternative hypotheses)</td>
</tr>
<tr class="odd">
<td>Всего гипотез</td>
<td><span class="math inline">\(m-R\)</span> – Общее число принятых гипотез</td>
<td><span class="math inline">\(R\)</span> – Общее число отвергнутых гипотез</td>
<td><span class="math inline">\(m\)</span> – всего гипотез</td>
</tr>
</tbody>
</table>
<p>В теории всего существует <span class="math inline">\(m_0\)</span> верных нулевых гипотез. В результате наших тестов мы ошибочно отвергаем <span class="math inline">\(FP\)</span> гипотез и верно принимаем остальные <span class="math inline">\(TN\)</span> гипотез. Также существует <span class="math inline">\(m−m_0\)</span> альтернативных гипотез, из которых <span class="math inline">\(TP\)</span> гипотез безошибочно отвергаются, а <span class="math inline">\(FN\)</span> гипотез – ошибочно принимаются. Важно, что общие количества отвергнутых и принятых гипотез (<span class="math inline">\(R\)</span> и <span class="math inline">\(m-R\)</span>), а следовательно, и суммарное число гипотез <span class="math inline">\(n\)</span> нам известны, тогда как остальные величины (<span class="math inline">\(m_0\)</span>, <span class="math inline">\(TN\)</span>, <span class="math inline">\(FP\)</span>, <span class="math inline">\(FN\)</span> и <span class="math inline">\(TP\)</span>) мы не наблюдаем.</p>
<section id="групповая-вероятность-ошибки-первого-рода-family-wise-error-rate" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="групповая-вероятность-ошибки-первого-рода-family-wise-error-rate"><span class="header-section-number">2.2.1</span> Групповая вероятность ошибки первого рода (family-wise error rate)</h3>
<p>При одновременной проверке семейства статистических гипотез мы хотим, чтобы количество наших ошибок (<span class="math inline">\(FP\)</span> и <span class="math inline">\(FN\)</span>) было минимальным. Традиционно исследователи пытаются минимизировать величину ошибочно отвергнутых гипотез <span class="math inline">\(FP\)</span>. Это вполне логично, поскольку ложно отвергнутая нулевая гипотеза грозит нам ложноположительным найденным эффектом, которого реально может не быть.</p>
<p>Если <span class="math inline">\(FP \geq 1\)</span>, мы совершаем как минимум одну ошибку первого рода. Вероятность допущения такой ошибки при множественной проверке гипотез называют групповой вероятностью ошибки (familywise error rate, FWER или experiment-wise error rate). По определению, <span class="math inline">\(FWER = P(FP \geq 1)\)</span> – вероятность ошибочно отклонить хотя бы одну нулевую гипотезу во всех тестах. Соответственно, когда мы говорим, что хотим контролировать групповую вероятность ошибки на определенном уровне значимости <span class="math inline">\(\alpha\)</span>, мы подразумеваем, что должно выполняться неравенство <span class="math inline">\(FWER \leq \alpha\)</span>.</p>
<p>Ниже мы обсудим методы, которые позволяют это делать.</p>
<section id="коррекция-бонферрони" class="level4" data-number="2.2.1.1">
<h4 data-number="2.2.1.1" class="anchored" data-anchor-id="коррекция-бонферрони"><span class="header-section-number">2.2.1.1</span> Коррекция Бонферрони</h4>
<p>Вернемся к нашему примеру, когда мы сравнили 3 группы A, B и C с помощью t-теста. Предположим, что мы получили следующие Р-значения: 0.001, 0.01 и 0.04.</p>
<p>Как было сказано выше, мы хотим, чтобы групповая вероятность ошибки была не больше уровня значимости <span class="math inline">\(FWER \leq \alpha\)</span>. Согласно методу Бонферрони, мы должны сравнить каждое из полученных p-значений не с <span class="math inline">\(\alpha\)</span>, а с <span class="math inline">\(\frac{\alpha}{n}\)</span>, где <span class="math inline">\(n\)</span> – число проверяемых гипотез. Деление исходного уровня значимости <span class="math inline">\(\alpha\)</span> на <span class="math inline">\(n\)</span> – это и есть поправка Бонферрони. В рассматриваемом примере каждое из полученных p-значений необходимо было бы сравнить с <span class="math inline">\(\frac{\alpha}{n}\)</span>, например, с <span class="math inline">\(\frac{0.01}{3}\approx 0.017\)</span>.</p>
<ul>
<li><span class="math inline">\(p-value_1=0.001 &lt; \alpha_{adjusted}=0.017\)</span> – гипотеза отклонена</li>
<li><span class="math inline">\(p-value_2=0.01 &lt; \alpha_{adjusted}=0.017\)</span> – гипотеза отклонена</li>
<li><span class="math inline">\(p-value_3=0.04 &gt; \alpha_{adjusted}=0.017\)</span> – гипотеза принята</li>
</ul>
<p>Вместо деления уровня значимости на число гипотез, мы могли бы умножить каждое p-значение на это число и получить точно такие же выводы (эта эквивалентная процедура реалирована в R):</p>
<ul>
<li><span class="math inline">\(p-value_{1,adjusted} = 0.001 \cdot 3 = 0.003 &lt; \alpha = 0.05\)</span> – гипотеза отклонена</li>
<li><span class="math inline">\(p-value_{2,adjusted} = 0.01 \cdot 3 = 0.03 &lt; \alpha = 0.05\)</span> – гипотеза отклонена</li>
<li><span class="math inline">\(p-value_{3,adjusted} = 0.04 \cdot 3 = 0.12 &gt; \alpha = 0.05\)</span> – гипотеза принята</li>
</ul>
<p>Иногда при домножении p-значений результат может получиться больше единицы. Из теории вероятностей мы знаем, что вероятность не может быть больше одного, поэтому в таких случаях p-значение принимают равным за единицу.</p>
<p>Различные виды коррекций p-значений представлены в функции <code>p.adjust()</code>, выбрать тип коррекции можно с помощью аргумента <code>method</code>. В этой функции используется домножение исходных p-значений на количество тестируемых гипотез, а не корректировка уровня значимости.</p>
<p>Проверим наши рассчеты:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.04</span>), <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003 0.030 0.120</code></pre>
</div>
</div>
<p>Можно на выходе сразу получить выводы относительно гипотез при <span class="math inline">\(\alpha = 5%\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.04</span>), <span class="at">method =</span> <span class="st">"bonferroni"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<p>Важно помнить об уязвимости коррекции Бонферрони – с ростом числа гипотез мощность метода уменьшается. Чем больше гипотез мы хотим проверить, тем сложнее нам будет их отвергать (даже если они реально должны быть отвергнуты). Например, для 5 групп (10 гипотез), применение поправки Бонферрони привело бы к снижению исходного уровня значимости до 0.01/10 = 0.001. Соответственно, для отклонения гипотез, соответствующие p-значения должны быть меньше 0.001, а это довольно жесткая отсечка. Из этого делаем вывод, что при большом числе гипотез коррекцию Бонферрони лучше не использовать.</p>
</section>
<section id="низходящая-процедура-хольма-хольма-бонферрони" class="level4" data-number="2.2.1.2">
<h4 data-number="2.2.1.2" class="anchored" data-anchor-id="низходящая-процедура-хольма-хольма-бонферрони"><span class="header-section-number">2.2.1.2</span> Низходящая процедура Хольма (Хольма-Бонферрони)</h4>
<p>Метод Хольма позволяет побороть недостатки метода Бонферрони. Он устроен следующим образом:</p>
<ul>
<li>Сначала p-значения сортируются по возрастанию <span class="math inline">\(\displaystyle{p-value_1 \leq p-value_2 \leq ... \leq p-value_n}\)</span>.</li>
<li>Затем проверяется условие для первого из p-значений: <span class="math inline">\(\displaystyle{p-value_1 \geq \frac{\alpha}{n-i+1}=\frac{\alpha}{n}}\)</span>, если условие выполнено, то все нулевые гипотезы принимаются, и процедура останавливается, иначе первая из гипотез отвергается, и начинается следующий шаг.</li>
<li>На следующем шаге проверяется условие <span class="math inline">\(\displaystyle{p-value_2 \geq \frac{\alpha}{n-i+1}=\frac{\alpha}{n-1}}\)</span>, если условние выполнено, то все гипотезы, начиная со второй, принимаются, иначе первые две гипотезы отклоняются и начинается следующий шаг.</li>
<li>На последнем шаге проверяется условие вида <span class="math inline">\(\displaystyle{p-value_n \geq \frac{\alpha}{n-n+1}}\)</span>, если оно выполнено, то последняя гипотеза принимается, если нет – отклоняется, на этом процедура заканчивается.</li>
</ul>
<p>Метод Хольма называют нисходящей (step-down) процедурой. Он начинается с наименьшего p-значения в упорядоченном ряду и последовательно “спускается” вниз к более высоким значениям. На каждом шаге соответствующее значение <span class="math inline">\(p-value_i\)</span> сравнивается со скорректированным уровнем значимости <span class="math inline">\(\displaystyle{\alpha_{adjusted}=\frac{\alpha}{n+i-1}}\)</span>. Аналогично коррекции Бонферрони можно вместо корректировки уровня значимости корректировать p-значения <span class="math inline">\(\displaystyle{p-value_{i,adjusted}=p-value_{i}\cdot(n-i+1)}\)</span> (эта эквивалентная процедура реалирована в R). Возвращаясь к нашему примеру:</p>
<ul>
<li><span class="math inline">\(p-value_{1,adjusted} = 0.001 \cdot (3-1+1) = 0.003 &lt; \alpha = 0.01\)</span> – гипотеза отклонена</li>
<li><span class="math inline">\(p-value_{2,adjusted} = 0.01 \cdot (3-2+1) = 0.02 &gt; \alpha = 0.01\)</span> – гипотеза принята</li>
<li><span class="math inline">\(p-value_{3,adjusted} = 0.04 \cdot (3-3+1) = 0.04 &gt; \alpha = 0.01\)</span> – гипотеза принята</li>
</ul>
<p>А теперь проверим себя с помощью R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.04</span>), <span class="at">method =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003 0.020 0.040</code></pre>
</div>
</div>
<p>И результаты проверки гипотез при <span class="math inline">\(\alpha =5%\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.04</span>), <span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE</code></pre>
</div>
</div>
</section>
</section>
<section id="средняя-доля-ложных-отклонений-false-discovery-rate" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="средняя-доля-ложных-отклонений-false-discovery-rate"><span class="header-section-number">2.2.2</span> Средняя доля ложных отклонений (false discovery rate)</h3>
<p>Рассмотренные выше FWER методы обеспечивают контроль над групповой вероятностью ошибки первого рода. Как мы выяснили, эти методы чересчур жестко работают, когда нужно одновременно проверить слишком много гипотез (падает статистическая мощность).Под “недостаточной мощностью” понимается сохранение многих нулевых гипотез, которые потенциально могут представлять исследовательский интерес и которые, соответственно, следовало бы отклонить. Недостаточная мощность традиционных процедур множественной проверки гипотез привела к разработке новых методов, например, метода Бенджамини-Хохберга.</p>
<p>Для преодоления недостаточной мощности FWER методов был предложен новый подход к проблеме множественных проверок статистических гипотез. Суть подхода заключается в том, что вместо контроля над групповой вероятностью ошибки первого рода выполняется контроль над ожидаемой долей ложных отклонений (false discovery rate, FDR) среди всех отклоненных гипотез.</p>
<p>В терминах таблицы выше эта ожидаемая доля может быть записана следующим образом: <span class="math inline">\(\displaystyle{FDR=\left(\frac{FP}{R}\right)}\)</span> (считают, что если <span class="math inline">\(R=0\)</span>, то и <span class="math inline">\(FDR=0\)</span>). Часто можно встретить запись через мат. ожидание <span class="math inline">\(\displaystyle{FDR=\mathbb{E}\left(\frac{FP}{R}\right)}\)</span>. FDR – ожидаемая доля ложных отклоненийсреди всех отклоненных гипотез.</p>
<p>В отличие от уровня значимости <span class="math inline">\(\alpha\)</span>, каких-либо общепринятых значений FDR не существует. Многие исследователи по аналогии контролируют FDR на уровне 5%. Интерпретация порогового значения FDR очень проста: например, если в ходе анализа данных отклонено 1000 гипотез, то при q=0.10 ожидаемая доля ложно отклоненных гипотез не превысит 100.</p>
<section id="восходящая-процедура-бенджамини-хохберга" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="восходящая-процедура-бенджамини-хохберга"><span class="header-section-number">2.2.2.1</span> Восходящая процедура Бенджамини — Хохберга</h4>
<p>В статье (Benjamini, Hochberg, 1995) описание процедуры контроля над FDR выглядит так:</p>
<ul>
<li>Сначала p-значения сортируются по возрастанию <span class="math inline">\(\displaystyle{p-value_1 \leq p-value_2 \leq ... \leq p-value_n}\)</span>.</li>
<li>Находят максимальное значение <span class="math inline">\(k\)</span> среди всех индексов <span class="math inline">\(i=1,...,n\)</span>, для которого <span class="math inline">\(p-value_i \leq \frac{i}{n}q\)</span> выполняется неравенство</li>
<li>Отклоняют все гипотезы <span class="math inline">\(H_i\)</span> с индексами <span class="math inline">\(i=1,...,k\)</span></li>
</ul>
<p>Эквивалентная процедура, реалированая в R отличается тем, что вместо нахождения максимального индекса <span class="math inline">\(k\)</span>, исходные p-значения корректируются следующим образом: <span class="math inline">\(q_i=\frac{p_in}{i}\)</span>.</p>
<p>В качестве примера рассмотрим следующий ряд из 15 упорядоченных по возрастанию p-значений (из оригинальной статьи Benjamini and Hochberg 1995):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.0004</span>, <span class="fl">0.0019</span>, <span class="fl">0.0095</span>,  <span class="fl">0.0201</span>, <span class="fl">0.0278</span>, <span class="fl">0.0298</span>, <span class="fl">0.0344</span>, <span class="fl">0.0459</span>, <span class="fl">0.3240</span>, <span class="fl">0.4262</span>, <span class="fl">0.5719</span>, <span class="fl">0.6528</span>, <span class="fl">0.7590</span>, <span class="fl">1.000</span>), <span class="at">method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00150000 0.00300000 0.00950000 0.03562500 0.06030000 0.06385714
 [7] 0.06385714 0.06450000 0.07650000 0.48600000 0.58118182 0.71487500
[13] 0.75323077 0.81321429 1.00000000</code></pre>
</div>
</div>
<p>И результаты проверки гипотез при <span class="math inline">\(\alpha =5 %\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.0004</span>, <span class="fl">0.0019</span>, <span class="fl">0.0095</span>,  <span class="fl">0.0201</span>, <span class="fl">0.0278</span>, <span class="fl">0.0298</span>, <span class="fl">0.0344</span>, <span class="fl">0.0459</span>, <span class="fl">0.3240</span>, <span class="fl">0.4262</span>, <span class="fl">0.5719</span>, <span class="fl">0.6528</span>, <span class="fl">0.7590</span>, <span class="fl">1.000</span>), <span class="at">method =</span> <span class="st">"BH"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>Интерпретация этих Р-значений с поправкой (в большинстве литературных источников их называют q-значениями) такова:</p>
<ul>
<li>Допустим, что мы хотим контролировать долю ложно отклоненных гипотез на уровне FDR = 0.05</li>
<li>Все гипотезы, q-значения которых <span class="math inline">\(q-value \leq 0.05\)</span>, отклоняются</li>
<li>Среди всех этих отклоненных гипотез доля отклоненных по ошибке не превышает 5%</li>
</ul>
<p>Коррекция Р-значений по методу Беньямини-Хохберга работает особенно хорошо в ситуациях, когда необходимо принять общее решение по какому-либо вопросу при наличии информации (=проверенных гипотез) по многим параметрам.</p>
<p>Следует помнить, что описанный здесь метод контроля над ожидаемой долей ложных отклонений предполагает, что все тесты, при помощи которых получают p-значения, независимы. На практике в большинстве случаев это условие выполняться не будет.</p>
</section>
<section id="восходящая-процедура-бенджамини-йекутили" class="level4" data-number="2.2.2.2">
<h4 data-number="2.2.2.2" class="anchored" data-anchor-id="восходящая-процедура-бенджамини-йекутили"><span class="header-section-number">2.2.2.2</span> Восходящая процедура Бенджамини-Йекутили</h4>
<p>Для преодоления ограничения независимости тестов при проверке гипотез в работе (Benjamini and Yekutieli 2001) был предложен усовершенствованный метод, учитывающий наличие корреляции между проверяемыми гипотезами.</p>
<p>Процедура Бенджамини-Йекутили очень похожа на процедуру Бенджамини-Хохберга. Основное отличие заключается во введении поправочной константы <span class="math inline">\(\displaystyle{c_n=\sum \limits_{i=1}^{n}\frac{1}{i}}\)</span>, далее аналогично:</p>
<ul>
<li>Сначала p-значения сортируются по возрастанию <span class="math inline">\(\displaystyle{p-value_1 \leq p-value_2 \leq ... \leq p-value_n}\)</span>.</li>
<li>Находят максимальное значение <span class="math inline">\(k\)</span> среди всех индексов <span class="math inline">\(i=1,...,n\)</span>, для которого <span class="math inline">\(p-value_i \leq \frac{i}{n} \frac{q}{c_n}\)</span> выполняется неравенство</li>
<li>Отклоняют все гипотезы <span class="math inline">\(H_i\)</span> с индексами <span class="math inline">\(i=1,...,k\)</span></li>
</ul>
<p>В R реализуется эквивалентная процедура:</p>
<p>Эквивалентная процедура, реалированая в R отличается тем, что вместо нахождения максимального индекса <span class="math inline">\(k\)</span>, исходные p-значения корректируются следующим образом: <span class="math inline">\(\displaystyle{q_i=\frac{p_i\cdot n\cdot c_n}{i}}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.0004</span>, <span class="fl">0.0019</span>, <span class="fl">0.0095</span>,  <span class="fl">0.0201</span>, <span class="fl">0.0278</span>, <span class="fl">0.0298</span>, <span class="fl">0.0344</span>, <span class="fl">0.0459</span>, <span class="fl">0.3240</span>, <span class="fl">0.4262</span>, <span class="fl">0.5719</span>, <span class="fl">0.6528</span>, <span class="fl">0.7590</span>, <span class="fl">1.000</span>), <span class="at">method =</span> <span class="st">"BY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.004977343 0.009954687 0.031523175 0.118211908 0.200089208 0.211892623
 [7] 0.211892623 0.214025770 0.253844518 1.000000000 1.000000000 1.000000000
[13] 1.000000000 1.000000000 1.000000000</code></pre>
</div>
</div>
<p>И результаты проверки гипотез при <span class="math inline">\(\alpha = 5%\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.0004</span>, <span class="fl">0.0019</span>, <span class="fl">0.0095</span>,  <span class="fl">0.0201</span>, <span class="fl">0.0278</span>, <span class="fl">0.0298</span>, <span class="fl">0.0344</span>, <span class="fl">0.0459</span>, <span class="fl">0.3240</span>, <span class="fl">0.4262</span>, <span class="fl">0.5719</span>, <span class="fl">0.6528</span>, <span class="fl">0.7590</span>, <span class="fl">1.000</span>), <span class="at">method =</span> <span class="st">"BY"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[13] FALSE FALSE FALSE</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="обобщающий-алгоритм-для-разных-процедур" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="обобщающий-алгоритм-для-разных-процедур"><span class="header-section-number">2.3</span> Обобщающий алгоритм для разных процедур</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Seminar_3_multiple_testing_plots/alg.png" class="img-fluid" style="width:70.0%"></p>
</div>
</div>
<p><a href="http://kmplot.com/multipletesting/multiple_testing_OH.pdf">Источник</a> – мне не очень нравится сам текст, но схема хорошая.</p>
</section>
<section id="симуляция-и-сравнение-результатов-работы-разных-коррекций-p-value" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="симуляция-и-сравнение-результатов-работы-разных-коррекций-p-value"><span class="header-section-number">2.4</span> Симуляция и сравнение результатов работы разных коррекций p-value</h2>
<p>Сравним как работают разные методы:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n<span class="sc">/</span><span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">3</span>, n<span class="sc">/</span><span class="dv">2</span>))) <span class="co"># генерим вектор t статистик</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="fu">sort</span>(<span class="sc">-</span><span class="fu">abs</span>(x))), <span class="dv">3</span>) <span class="co"># переводим статистики в p-value</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>default_bool <span class="ot">&lt;-</span> pval <span class="sc">&lt;</span> alpha <span class="co"># вектор с исходными выводами о принятии гипотез без коррекции</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>bonferroni_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>bonferroni_bool <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"bonferroni"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>holm_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"holm"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>holm_bool <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"holm"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>bh_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BH"</span>) </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>bh_bool <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BH"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>by_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BY"</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>by_bool <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">"BY"</span>) <span class="sc">&lt;</span> alpha <span class="co"># отклоняем H_0 (есть эффект)? </span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">cbind</span>(default_bool, bonferroni_bool, holm_bool, bh_bool, by_bool) <span class="co"># склеиваем столбики с выводами о принятии гипотез для разных корректировок; если бы вдруг хотели склеить строчки, то есть аналогичная функция rbind()</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(methods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Без коррекции'</span>, <span class="st">'Бонферрони'</span>, <span class="st">'Хольм'</span>, <span class="st">'Бенджамини-Хохберг'</span>, <span class="st">'Бенджамини-Йекутили'</span>) <span class="co"># добавляем шапку таблицы</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(methods) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n) <span class="co"># добавляем номера строчкам</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>methods</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Без коррекции Бонферрони Хольм Бенджамини-Хохберг Бенджамини-Йекутили
1           TRUE       TRUE  TRUE               TRUE                TRUE
2           TRUE       TRUE  TRUE               TRUE                TRUE
3           TRUE       TRUE  TRUE               TRUE                TRUE
4           TRUE       TRUE  TRUE               TRUE                TRUE
5           TRUE       TRUE  TRUE               TRUE                TRUE
6           TRUE       TRUE  TRUE               TRUE                TRUE
7           TRUE       TRUE  TRUE               TRUE                TRUE
8           TRUE       TRUE  TRUE               TRUE                TRUE
9           TRUE       TRUE  TRUE               TRUE                TRUE
10          TRUE       TRUE  TRUE               TRUE                TRUE
11          TRUE      FALSE  TRUE               TRUE                TRUE
12          TRUE      FALSE FALSE               TRUE                TRUE
13          TRUE      FALSE FALSE               TRUE               FALSE
14          TRUE      FALSE FALSE               TRUE               FALSE
15          TRUE      FALSE FALSE               TRUE               FALSE
16          TRUE      FALSE FALSE               TRUE               FALSE
17          TRUE      FALSE FALSE               TRUE               FALSE
18          TRUE      FALSE FALSE               TRUE               FALSE
19          TRUE      FALSE FALSE               TRUE               FALSE
20          TRUE      FALSE FALSE               TRUE               FALSE
21          TRUE      FALSE FALSE              FALSE               FALSE
22          TRUE      FALSE FALSE              FALSE               FALSE
23         FALSE      FALSE FALSE              FALSE               FALSE
24         FALSE      FALSE FALSE              FALSE               FALSE
25         FALSE      FALSE FALSE              FALSE               FALSE
26         FALSE      FALSE FALSE              FALSE               FALSE
27         FALSE      FALSE FALSE              FALSE               FALSE
28         FALSE      FALSE FALSE              FALSE               FALSE
29         FALSE      FALSE FALSE              FALSE               FALSE
30         FALSE      FALSE FALSE              FALSE               FALSE
31         FALSE      FALSE FALSE              FALSE               FALSE
32         FALSE      FALSE FALSE              FALSE               FALSE
33         FALSE      FALSE FALSE              FALSE               FALSE
34         FALSE      FALSE FALSE              FALSE               FALSE
35         FALSE      FALSE FALSE              FALSE               FALSE
36         FALSE      FALSE FALSE              FALSE               FALSE
37         FALSE      FALSE FALSE              FALSE               FALSE
38         FALSE      FALSE FALSE              FALSE               FALSE
39         FALSE      FALSE FALSE              FALSE               FALSE
40         FALSE      FALSE FALSE              FALSE               FALSE
41         FALSE      FALSE FALSE              FALSE               FALSE
42         FALSE      FALSE FALSE              FALSE               FALSE
43         FALSE      FALSE FALSE              FALSE               FALSE
44         FALSE      FALSE FALSE              FALSE               FALSE
45         FALSE      FALSE FALSE              FALSE               FALSE
46         FALSE      FALSE FALSE              FALSE               FALSE
47         FALSE      FALSE FALSE              FALSE               FALSE
48         FALSE      FALSE FALSE              FALSE               FALSE
49         FALSE      FALSE FALSE              FALSE               FALSE
50         FALSE      FALSE FALSE              FALSE               FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pval, bonferroni_pval, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pval, holm_pval, <span class="at">col=</span><span class="st">"green"</span>, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pval, bh_pval, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pval, by_pval, <span class="at">col=</span><span class="st">"violet"</span>, <span class="at">type=</span><span class="st">"p"</span>, <span class="at">pch=</span><span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>alpha, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>alpha, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="fl">0.6</span>, <span class="at">y=</span><span class="fl">0.5</span>, <span class="co"># координаты верхнего левого угла легенды</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">'Бонферрони'</span>, <span class="st">'Хольм'</span>, <span class="st">'Бенджамини-Хохберг'</span>, <span class="st">'Бенджамини-Йекутили'</span>, <span class="st">'Уровень значимости'</span>), <span class="co"># категории легенды</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"violet"</span>, <span class="st">"red"</span>), <span class="co"># цвета категорий</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="co"># чтобы не было рамочки вокруг легенды</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="dv">1</span>) <span class="co"># форма маркера</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="multiple_testing_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./experiments.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Эксперименты</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bad_control.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Плохой контроль</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>